document.addEventListener("DOMContentLoaded",(function(){iniciarAPI()}));const mostrar={id:"",titulo:"",productos:[]},orden={id:"",modo:"",fecha:"",hora:"",productos:[]};function iniciarAPI(){"/admin"===window.location.pathname&&consultarTipos(),window.location.pathname.includes("/ordenes")&&buscador()}async function consultarTipos(){try{const e="/api/tipos",t=await fetch(e);consultarProductos(await t.json())}catch(e){console.log(e)}}async function consultarProductos(e){const t=await fetch("/api/productos");mostrarTipos(e,await t.json())}function mostrarTipos(e,t){e.forEach(e=>{mostrar.id=e.id,mostrar.titulo=e.titulo,t.forEach(t=>{e.id===t.idTipo&&mostrar.productos.push(t)}),mostrarProductos(e)})}function mostrarProductos(e){const t=document.querySelector("#pedido-local"),o=document.createElement("H1");o.textContent=mostrar.titulo;const n=document.createElement("DIV");n.classList.add("pedido-local");const c=document.createElement("DIV");c.classList.add("tipo"),t.appendChild(n),n.appendChild(o),n.appendChild(c),mostrar.productos.forEach(t=>{if(e.id===t.idTipo){const e=document.createElement("DIV");e.classList.add("cuerpo-producto"),e.dataset.idProducto=t.id,e.onclick=function(){seleccionarProducto(t)};const o=document.createElement("DIV");o.classList.add("imagen");const n=document.createElement("IMG");n.src="/imagenes/"+t.imagen,n.alt="Imagen de Producto";const d=document.createElement("DIV");d.classList.add("contenido");const a=document.createElement("H2");a.textContent=t.titulo;const r=document.createElement("H3");r.textContent="₡"+t.precio,r.classList.add("precio"),d.appendChild(a),d.appendChild(r),o.appendChild(n),e.appendChild(o),e.appendChild(d),c.appendChild(e)}})}function seleccionarProducto(e){const{id:t}=e,{productos:o}=orden,n=document.querySelector(`[data-id-producto="${t}"]`),c=document.querySelector("#confirmar");c.onclick=function(){confirmarOrden()},o.some(e=>e.id===t)?(orden.productos=o.filter(e=>e.id!==t),n.classList.remove("agregado")):(orden.productos=[...o,e],n.classList.add("agregado")),orden.productos.length>0?c.classList.add("mostrar"):c.classList.remove("mostrar")}function confirmarOrden(){const e=document.querySelector("#id");if(orden.id=e.textContent,"1"===orden.id){orden.modo=0;const e=new Date;orden.fecha=e.toLocaleDateString();let t=e.getMinutes();t<9&&(t="0"+t),orden.hora=e.getHours()+":"+t}else orden.modo=1;limpiar("#pedido-local"),mostrarResumen()}function mostrarResumen(){const{productos:e}=orden;let t=0;document.querySelector("#confirmar").classList.remove("mostrar");const o=document.querySelector("#guardar");o.classList.add("mostrar"),o.onclick=function(){guardarOrden()};const n=document.querySelector("#pedido-local"),c=document.createElement("DIV");c.classList.add("resumen-local");const d=document.createElement("h1");d.textContent="Resumen de Orden";const a=document.createElement("P");a.classList.add("tiempo"),a.textContent="Fecha: "+orden.fecha;const r=document.createElement("P");r.classList.add("tiempo"),r.textContent="Hora: "+orden.hora;const i=document.createElement("H2");i.classList.add("total"),c.appendChild(d),c.appendChild(a),c.appendChild(r),n.appendChild(c),e.forEach(e=>{const o=parseInt(e.precio);t+=o,i.textContent="Total: ₡"+t;const n=document.createElement("DIV");n.classList.add("resumen");const d=document.createElement("DIV");d.classList.add("producto");const a=document.createElement("H3");a.textContent=e.titulo;const r=document.createElement("H3");r.classList.add("precio"),r.textContent="₡"+o;const s=document.createElement("BUTTON");s.classList.add("boton"),s.classList.add("eliminar"),s.textContent="Eliminar",s.onclick=function(){eliminarDeResumen(e)},d.appendChild(a),d.appendChild(r),n.appendChild(d),n.appendChild(s),c.appendChild(n)}),c.appendChild(i)}async function guardarOrden(){const{id:e,modo:t,fecha:o,hora:n,productos:c}=orden,d=c.map(e=>e.id),a=new FormData;a.append("usuarioId",e),a.append("modo",t),a.append("fecha",o),a.append("hora",n),a.append("productos",d);try{const e="/api/guardar",t=await fetch(e,{method:"POST",body:a});(await t.json()).resultado&&(Swal.fire({title:"Orden Creada Correctamente",icon:"success"}),setTimeout(()=>{window.location.reload()},2e3))}catch(e){console.log(e)}}function eliminarDeResumen(e){const{id:t}=e,{productos:o}=orden;orden.productos=o.filter(e=>e.id!==t),confirmarOrden(),1===o.length&&window.location.reload()}function limpiar(e){const t=document.querySelector(e);for(;t.firstChild;)t.removeChild(t.firstChild)}function buscador(){document.querySelector("#fecha").addEventListener("input",e=>{const t=e.target.value;window.location="?fecha="+t})}function iniciarApp(){menu()}function menu(){const e=document.querySelector("#menu"),t=document.querySelector("#sidebar"),o=document.querySelector("#cerrar");e.addEventListener("click",(function(){t.classList.add("mostrar"),setTimeout(()=>{t.classList.add("opacity-in")},0)})),o.addEventListener("click",(function(){t.classList.add("opacity-out"),t.classList.remove("opacity-in"),setTimeout(()=>{t.classList.remove("mostrar"),t.classList.remove("opacity-out")},200)}))}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));
//# sourceMappingURL=bundle.js.map
