document.addEventListener("DOMContentLoaded",(function(){iniciarAPI()}));const mostrar={id:"",titulo:"",productos:[]},orden={id:"",modo:"",fecha:"",hora:"",productos:[]};function iniciarAPI(){"/admin"===window.location.pathname&&consultarTipos(),window.location.pathname.includes("/ordenes")&&buscador()}async function consultarTipos(){try{const t="/api/tipos",e=await fetch(t);consultarProductos(await e.json())}catch(t){console.log(t)}}async function consultarProductos(t){const e=await fetch("/api/productos");mostrarTipos(t,await e.json())}function mostrarTipos(t,e){t.forEach(t=>{mostrar.id=t.id,mostrar.titulo=t.titulo,e.forEach(e=>{t.id===e.idTipo&&mostrar.productos.push(e)}),mostrarProductos(t)})}function mostrarProductos(t){const e=document.querySelector("#pedido-local"),o=document.createElement("H1");o.textContent=mostrar.titulo;const n=document.createElement("DIV");n.classList.add("pedido-local");const c=document.createElement("DIV");c.classList.add("tipo"),e.appendChild(n),n.appendChild(o),n.appendChild(c),mostrar.productos.forEach(e=>{if(t.id===e.idTipo){const t=document.createElement("DIV");t.classList.add("cuerpo-producto"),t.dataset.idProducto=e.id,t.onclick=function(){seleccionarProducto(e)};const o=document.createElement("DIV");o.classList.add("imagen");const n=document.createElement("IMG");n.src="/imagenes/"+e.imagen,n.alt="Imagen de Producto";const d=document.createElement("DIV");d.classList.add("contenido");const a=document.createElement("H2");a.textContent=e.titulo;const r=document.createElement("H3");r.textContent="₡"+e.precio,r.classList.add("precio"),d.appendChild(a),d.appendChild(r),o.appendChild(n),t.appendChild(o),t.appendChild(d),c.appendChild(t)}})}function seleccionarProducto(t){const{id:e}=t,{productos:o}=orden,n=document.querySelector(`[data-id-producto="${e}"]`),c=document.querySelector("#confirmar");c.onclick=function(){confirmarOrden()},o.some(t=>t.id===e)?(orden.productos=o.filter(t=>t.id!==e),n.classList.remove("agregado")):(orden.productos=[...o,t],n.classList.add("agregado")),orden.productos.length>0?c.classList.add("mostrar"):c.classList.remove("mostrar")}function confirmarOrden(){const t=document.querySelector("#id");if(orden.id=t.textContent,"1"===orden.id){orden.modo=0;const t=new Date;orden.fecha=t.toLocaleDateString();let e=t.getMinutes();e<9&&(e="0"+e),orden.hora=t.getHours()+":"+e}else orden.modo=1;limpiar("#pedido-local"),mostrarResumen()}function mostrarResumen(){const{productos:t}=orden;let e=0;document.querySelector("#confirmar").classList.remove("mostrar");const o=document.querySelector("#guardar");o.classList.add("mostrar"),o.onclick=guardarOrden;const n=document.querySelector("#pedido-local"),c=document.createElement("DIV");c.classList.add("resumen-local");const d=document.createElement("h1");d.textContent="Resumen de Orden";const a=document.createElement("P");a.classList.add("tiempo"),a.textContent="Fecha: "+orden.fecha;const r=document.createElement("P");r.classList.add("tiempo"),r.textContent="Hora: "+orden.hora;const i=document.createElement("H2");i.classList.add("total"),c.appendChild(d),c.appendChild(a),c.appendChild(r),n.appendChild(c),t.forEach(t=>{const o=parseInt(t.precio);e+=o,i.textContent="Total: ₡"+e;const n=document.createElement("DIV");n.classList.add("resumen");const d=document.createElement("DIV");d.classList.add("producto");const a=document.createElement("H3");a.textContent=t.titulo;const r=document.createElement("H3");r.classList.add("precio"),r.textContent="₡"+o;const s=document.createElement("BUTTON");s.classList.add("boton"),s.classList.add("eliminar"),s.textContent="Eliminar",s.onclick=function(){eliminarDeResumen(t)},d.appendChild(a),d.appendChild(r),n.appendChild(d),n.appendChild(s),c.appendChild(n)}),c.appendChild(i)}async function guardarOrden(){const{id:t,modo:e,fecha:o,hora:n,productos:c}=orden,d=c.map(t=>t.id),a=new FormData;a.append("usuarioId",t),a.append("modo",e),a.append("fecha",o),a.append("hora",n),a.append("productos",d),Swal.fire({icon:"success",title:"Guardado Exitosamente"}),setTimeout(()=>{window.location.reload()},2e3);try{const t="/api/guardar",e=await fetch(t,{method:"POST",body:a});await e.json()}catch(t){console.log(t)}}function eliminarDeResumen(t){const{id:e}=t,{productos:o}=orden;orden.productos=o.filter(t=>t.id!==e),confirmarOrden(),1===o.length&&window.location.reload()}function limpiar(t){const e=document.querySelector(t);for(;e.firstChild;)e.removeChild(e.firstChild)}function buscador(){document.querySelector("#fecha").addEventListener("input",t=>{const e=t.target.value;window.location="?fecha="+e})}function iniciarApp(){menu()}function menu(){const t=document.querySelector("#menu"),e=document.querySelector("#sidebar"),o=document.querySelector("#cerrar");t.addEventListener("click",(function(){e.classList.add("mostrar"),setTimeout(()=>{e.classList.add("opacity-in")},0)})),o.addEventListener("click",(function(){e.classList.add("opacity-out"),e.classList.remove("opacity-in"),setTimeout(()=>{e.classList.remove("mostrar"),e.classList.remove("opacity-out")},200)}))}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));
//# sourceMappingURL=bundle.js.map
